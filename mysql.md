# Mysql

## Installation

### Linux

```shell
$ sudo apt install mysql-server
$ sudo systemctl start mysql
$ sudo systemctl status mysql # check the status of mysql.
```

### macOS

```shell
$ brew install mysql
$ brew services start mysql
```

## Login

```shell
$ mysql -u root
```

### SQL

```sql
// list databases
$ show databases

// create database
$ create database ${database}

// 
$ show columns from ${table} = describe ${table}

// show the status of mysql server
$ show status 

// show the security authentication of user
$ show grant

// the DISTINCT will be applied for all the columns.
$ SELECT DISTINCT ${column1}, ${column2} from ${TABLE}.   

// 
$ SELECT ${column} from ${table} LIMIT 5,5  = LIMIT 5 OFFSET 5;

// The sequence of a MYSQL with where, order, limit
$ SELECT * from ${table} WHERE id=1 (GROUP by) (Having xxx) order by ${column} limit 1;

// 
$ select * from $table where ${column} REGEXP '111';

// concat, rtrim, ltrim
$ select concat(rtrim(${column1}), ",", ${column2}) as ${ALIAS} from ${TABLE}

// Date()
$ select ${column1}, ${column2} from orders where Date(order_date) = '2005-09-01'

// aggregate function
$ AVG(DISTINCT ${column}) AS xxx. 

// GROUP BY and Having
$ select cust_id, count(*) as orders from orders GROUP By cust_id Having count(*) >= 2;

// 
$ UNION ALL

// INSERT 
INSERT (LOW_PRIORITY) INTO $TABLE(col1, col2, col3) VALUES(val1, val2, val3);

// multiple columns
INSERT INTO ${TABLE}(col1, col2, col3) VALUES(val1, val2, val3), (val1, val2, val3);

// update
UPDATE IGNORE 

// delete use update to delete certain column, delete all the column use TRUNCATE TABLE

// create, AUTO_INCREMENT must be indexed, use last_insert_id() to get the id generated by AUTO_INCREMENT
CREATE TABLE customers IF NOT EXISTS
{
	cust_id int NOT NULL AUTO_INCREMENT DEFAULT '1',
  ...
  PRIMARY KEY (cust_id, id2)
} ENGINE=InnoDB;

// UPDATE TABLE
ALTER TABLE vendors 
ADD vend_phone CHAR(20);

ALTER TABLE vendors
DROP column vend_phone;

ALTER TABLE orderitems
ADD CONSTRAINT fk_orderitems_orders
FOREIGN KEY (order_num) REFERENCES orders (order_num);

DROP TABLE xxx.

RENAME xxx to xxx;




```

## Wildcard

### _ and %



## View

```sql
$ SHOW CREATE VIEW viename 
$ CREATE OR REPLACE VIEW xxx AS (SELECT xxx)
```







## Tips in using mysql

1. **Do not ** use * to get all the columns unless you really need that.
2. Mysql is **not** case-sensitive by default.
3. The precedence of AND > the precedence of OR
4. % can not match **NULL** value
5. two usage of ^, one for [\^123]. or ^123 
6. function is not portable.
7. The difference between COUNT(*) and COUNT(column), the former include the column which value = NULL.
8. The difference between **WHERE** and **HAVING**, **WHERE** filter data before group, **HAVING** filter data after group.
9. The order SELECT > FROM > WHERE > GROUP BY > HAVING > ORDER BY > LIMIT
10. Foreign key
11. INNER JOIN / LEFT OUTER JOIN / RIGHT OUTER JOIN /
